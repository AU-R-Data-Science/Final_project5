---
title: "Final_Project"
author: "Shawn Yates"
date: "2022-11-14"
output: html_document
---

```{r}
library(ggplot2)
library(dplyr)
```

```{r}
data <- read.csv("~/Documents/GitHub/Final_project5/crop.data.csv")
head(data)
```

```{r}
#sigmoid function defined as p, inverse of logit
sigmoid <- function(z){1/(1+exp(-z))} 

#objective function to be minimized
obj_fn <- function(beta, X, y){
  n <- length(y) # number of training examples

  p <- sigmoid(X%*%beta)
  beta_hat <- (t(-y)%*%log(p)-t(1-y)%*%log(1-p))/n
  beta_hat
}
```

```{r}
#gradient function
grad <- function(theta, X, y){
  n <- length(y)
  p <- sigmoid(X%*%beta)
  grad <- (t(X)%*%(p - y))/n
  grad
}
```

```{r}
logisticReg <- function(X, y){
  #remove NA rows
  temp <- na.omit(cbind(y, X))
  #add bias term and convert to matrix
  X <- mutate(temp[, -1], bias =1)
  X <- as.matrix(X[,c(ncol(X), 1:(ncol(X)-1))])
  y <- as.matrix(temp[, 1])
  #initialize theta
  beta <- matrix(rep(0, ncol(X)), nrow = ncol(X))
  #use the optim function to perform gradient descent
  costOpti <- optim(matrix(rep(0, 4), nrow = 4), obj_fn, grad, X=X, y=y)
  #return coefficients
  return(costOpti$par)
}
```
##### Training our model with crop dataset
```{r}
data.X <- data[, -1]
data.y <- data[, 1]
```

```{r}
model <- logisticReg(data.X, data.y)
model
```


```{r}
#true.model <- glm(as.factor(density) ~ block + fertilizer + yield, family=binomial(link ="logit"), data=data)

#summary(true.model)$coefficients
```
